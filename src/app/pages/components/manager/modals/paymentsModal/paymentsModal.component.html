<div
    class="row justify-content-center"
    [class.component-dark-theme]="themeService.isDark()"
    [class.component-rtl-enabled]="themeService.isRTLEnabled()"
>
    <mat-dialog-content class="mat-typography">
        <mat-stepper linear #stepper>
            <mat-step [stepControl]="preFactura" [editable]="'true'">
                <form [formGroup]="preFactura">
                    <ng-template matStepLabel>Generar factura</ng-template>
                    <mat-card class="example-card">
                        <div class="container-fluid">
                            <h3 class="text-center mt-3">Generar Prefactura</h3>

                            <mat-card-content>
                                <form [formGroup]="preFactura">
                                    <div class="row mt-3">
                                        <div class="col-12">
                                            <div>
                                                <mat-form-field
                                                    class="w-100 mt-2"
                                                >
                                                    <mat-label
                                                        >Documento
                                                        usuario</mat-label
                                                    >
                                                    <input
                                                        type="number"
                                                        matInput
                                                        formControlName="docuUser"
                                                        placeholder=""
                                                    />
                                                </mat-form-field>
                                            </div>
                                        </div>
                                    </div>

                                    <div class="row">
                                        <div class="col-6">
                                            <div>
                                                <mat-form-field class="w-100">
                                                    <mat-label
                                                        >Nombre Completo
                                                    </mat-label>
                                                    <input
                                                        type="text"
                                                        matInput
                                                        formControlName="fullName"
                                                        placeholder=""
                                                    />
                                                </mat-form-field>
                                            </div>
                                        </div>
                                        <div class="col-6">
                                            <div>
                                                <mat-form-field class="w-100">
                                                    <mat-label
                                                        >Número de Documento
                                                    </mat-label>
                                                    <input
                                                        type="number"
                                                        matInput
                                                        formControlName="document"
                                                        placeholder=""
                                                    />
                                                </mat-form-field>
                                            </div>
                                        </div>
                                    </div>

                                    <div class="row">
                                        <div class="col-6">
                                            <div>
                                                <mat-form-field class="w-100">
                                                    <mat-label
                                                        >Correo Eléctronico
                                                    </mat-label>
                                                    <input
                                                        type="text"
                                                        matInput
                                                        formControlName="email"
                                                        placeholder=""
                                                    />
                                                </mat-form-field>
                                            </div>
                                        </div>
                                        <div class="col-6">
                                            <div>
                                                <mat-form-field class="w-100">
                                                    <mat-label
                                                        >Telefono</mat-label
                                                    >
                                                    <input
                                                        type="number"
                                                        matInput
                                                        formControlName="movil"
                                                        placeholder=""
                                                    />
                                                </mat-form-field>
                                            </div>
                                        </div>
                                    </div>

                                    <div class="row">
                                        <div class="col-6">
                                            <div>
                                                <app-selectpaymethod
                                                    (methodSelected)="
                                                        methodSelected($event)
                                                    "
                                                ></app-selectpaymethod>
                                            </div>
                                        </div>
                                        <div
                                            class="col-6"
                                            *ngIf="validateReference()"
                                        >
                                            <div>
                                                <mat-form-field class="w-100">
                                                    <mat-label
                                                        >Referencia de pago
                                                    </mat-label>
                                                    <input
                                                        type="text"
                                                        matInput
                                                        formControlName="code"
                                                        placeholder=""
                                                    />
                                                </mat-form-field>
                                            </div>
                                        </div>
                                    </div>

                                    <div class="row">
                                        <div class="col-12">
                                            <mat-form-field class="w-100">
                                                <mat-label>Descuento</mat-label>
                                                <input
                                                    type="number"
                                                    matInput
                                                    formControlName="managerDiscount"
                                                    placeholder=""
                                                />
                                            </mat-form-field>
                                        </div>
                                    </div>

                                    <div class="row">
                                        <div class="col-12">
                                            <mat-form-field class="w-100">
                                                <mat-label
                                                    >Observaciones</mat-label
                                                >
                                                <textarea
                                                    matInput
                                                    placeholder=""
                                                    formControlName="observationBilling"
                                                ></textarea>
                                            </mat-form-field>
                                        </div>
                                    </div>
                                </form>
                            </mat-card-content>
                            <mat-card-actions class="mb-3">
                                <button
                                    mat-raised-button
                                    matStepperNext
                                    color="primary"
                                    (click)="createPreBillingMan(stepper)"
                                >
                                    Generar pre factura
                                </button>
                                <button mat-button (click)="closeDialog()">
                                    Cerrar
                                </button>
                            </mat-card-actions>
                        </div>
                    </mat-card>
                    <!-- <div>
                <button mat-button matStepperNext>Next</button>
            </div> -->
                </form>
            </mat-step>
            <mat-step [stepControl]="secondFormGroup" [editable]="'false'">
                <form [formGroup]="secondFormGroup">
                    <ng-template matStepLabel>Pagar factura</ng-template>
                    <mat-card
                        class="mb-10 tagus-card"
                        [class.component-dark-theme]="themeService.isDark()"
                        [class.component-rtl-enabled]="
                            themeService.isRTLEnabled()
                        "
                    >
                        <mat-card-header
                            class="align-items-center border-bottom"
                        >
                            <h5 class="mb-0">Detalle de la factura</h5>
                        </mat-card-header>
                        <mat-card-content>
                            <div class="table-responsive w-full">
                                <table class="table">
                                    <thead>
                                        <tr>
                                            <th class="fw-semibold main-color">
                                                No
                                            </th>
                                            <th
                                                class="fw-semibold gray-color text-start"
                                            >
                                                Servicio
                                            </th>
                                            <th
                                                class="fw-semibold gray-color text-start"
                                            ></th>
                                            <th
                                                class="fw-semibold gray-color text-end"
                                            >
                                                Precio
                                            </th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        <tr>
                                            <td class="main-color fw-semibold">
                                                01.
                                            </td>
                                            <td class="text-start fw-semibold">
                                                {{
                                                    PayBill
                                                        ?.serviceDescription[0]
                                                        ?.nameService
                                                }}
                                                {{
                                                    PayBill
                                                        ?.serviceDescription[0]
                                                        ?.nameTypeService
                                                }}
                                            </td>
                                            <td
                                                class="main-color fw-semibold"
                                            ></td>
                                            <td class="gray-color text-end">
                                                {{
                                                    PayBill
                                                        ?.serviceDescription[0]
                                                        ?.servicePrice
                                                }}
                                            </td>
                                        </tr>
                                        <tr
                                            *ngFor="
                                                let serv of PayBill
                                                    ?.serviceDescription[0]
                                                    ?.AddServiceDescription;
                                                let i = index
                                            "
                                        >
                                            <td class="main-color fw-semibold">
                                                0{{ i + 2 }}.
                                            </td>
                                            <td class="text-start fw-semibold">
                                                {{ serv?.serviceName }}
                                            </td>
                                            <td
                                                class="main-color fw-semibold"
                                            ></td>
                                            <td class="gray-color text-end">
                                                {{ serv?.CostService }}
                                            </td>
                                        </tr>
                                        <tr>
                                            <td></td>
                                            <td
                                                class="main-color fw-semibold"
                                            ></td>
                                            <td class="gray-color fw-semibold">
                                                Subtotal:
                                            </td>
                                            <td
                                                class="gray-color fw-semibold text-end"
                                            >
                                                {{ PayBill?.subTotal }}
                                            </td>
                                        </tr>
                                        <tr>
                                            <td></td>
                                            <td
                                                class="main-color fw-semibold"
                                            ></td>
                                            <td class="gray-color fw-semibold">
                                                {{ PayBill?.taxes?.taxes }}:
                                            </td>
                                            <td
                                                class="gray-color fw-semibold text-end"
                                            >
                                                {{ PayBill?.taxes?.taxValue }}
                                            </td>
                                        </tr>
                                        <tr>
                                            <td></td>
                                            <td
                                                class="main-color fw-semibold"
                                            ></td>
                                            <td class="gray-color fw-semibold">
                                                Descuento:
                                            </td>
                                            <td
                                                class="gray-color fw-semibold text-end"
                                            >
                                                {{ PayBill?.discount.discount }}
                                            </td>
                                        </tr>
                                        <tr class="total">
                                            <td></td>
                                            <td
                                                class="main-color fw-semibold"
                                            ></td>
                                            <td class="fw-semibold">Total:</td>
                                            <td class="fw-semibold text-end">
                                                {{ PayBill?.grandTotal }}
                                            </td>
                                        </tr>
                                        <tr>
                                            <td></td>
                                            <td></td>
                                            <td
                                                class="main-color fw-semibold"
                                            ></td>
                                            <td class="text-end">
                                                <div class="btn-box">
                                                    <button
                                                        mat-button
                                                        class="mr-5"
                                                        (click)="closeDialog()"
                                                    >
                                                        Cerrar
                                                    </button>
                                                    <button
                                                        mat-flat-button
                                                        class="tagus"
                                                        (click)="
                                                            RealizarPagoBill()
                                                        "
                                                    >
                                                        Registrar pago
                                                    </button>
                                                </div>
                                            </td>
                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                        </mat-card-content>
                    </mat-card>
                </form>
            </mat-step>
        </mat-stepper>
    </mat-dialog-content>
</div>
